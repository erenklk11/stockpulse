<div class="logo">
  <img src="/logo.jpg" width="60px" height="60px" alt="Logo" />
</div>

<div class="login-container">
  <!-- Loading state -->
  <div *ngIf="isLoading">
    <div class="header-container">
      <h2>Verifying...</h2>
    </div>
  </div>

  <!-- Error state -->
  <div *ngIf="!isLoading && !isTokenValid">
    <div class="header-container">
      <i routerLink="/auth/login" class="back-arrow fas fa-arrow-left"></i>
      <h2>Token Verification Failed</h2>
    </div>

    <div class="error-message">
      {{ errorMessage }}
    </div>

    <p>Please request a new password reset link.</p>

    <div class="footer-container">
      <a routerLink="/auth/forgot-password">Request new reset link</a>
    </div>
  </div>

  <!-- Success state - Reset Password Form -->
  <div *ngIf="!isLoading && isTokenValid">
    <div class="header-container">
      <i routerLink="/auth/login" class="back-arrow fas fa-arrow-left"></i>
      <h2>Reset Password</h2>
    </div>

    <div *ngIf="responseMessage" [ngClass]="responseClass">
      {{ responseMessage }}
    </div>

    <form *ngIf="!isSuccess" [formGroup]="formGroup" (ngSubmit)="submit()">
      <div class="form-group">
        <label for="password">New Password</label>
        <div class="input-container">
          <i class="input-icon fas fa-lock"></i>
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            name="password"
            formControlName="password"
            class="form-control"
            [ngClass]="{ 'is-invalid': (formGroup.get('password')?.errors && firstAttemptMade) }"
            placeholder="Enter your new password*"
          />
          <i
            class="toggle-password-visibility fas"
            [ngClass]="showPassword ? 'fa-eye' : 'fa-eye-slash'"
            (click)="togglePasswordVisibility()"
          ></i>
        </div>
        <div *ngIf="formGroup.get('password')?.errors?.['required'] && firstAttemptMade" class="invalid-feedback">
          Password is required.
        </div>
        <div *ngIf="formGroup.get('password')?.errors?.['minlength'] && firstAttemptMade" class="invalid-feedback">
          Password must be at least {{passwordMinLength}} characters long.
        </div>
      </div>

      <div class="form-group">
        <button type="submit" class="login-btn" [disabled]="!formGroup.valid">
          Reset Password
        </button>
      </div>
    </form>
  </div>
</div>
